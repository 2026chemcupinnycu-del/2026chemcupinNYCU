<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 å¤§åŒ–ç›ƒæŠ½ç±¤ç³»çµ±</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 p-5">
    <div id="draw-app" class="max-w-5xl mx-auto">
        <header class="text-center mb-8">
            <h1 class="text-3xl font-black text-[#001f54] mb-2">2026 å¤§åŒ–ç›ƒé è³½åˆ†çµ„æŠ½ç±¤</h1>
            <div class="mt-4 flex flex-col items-center">
                <select v-model="selectedCategory" @change="resetDraw" class="bg-white border-2 border-[#001f54] text-[#001f54] font-black py-2 px-6 rounded-xl shadow-sm focus:outline-none">
                    <option v-for="(data, cat) in categoryData" :key="cat" :value="cat">{{ cat }}</option>
                </select>
            </div>
            <div class="mt-4 inline-block bg-blue-100 text-blue-800 px-4 py-1 rounded-full text-sm font-bold">
                {{ selectedCategory }}ï¼šå…± {{ currentTeams.length }} éšŠ
            </div>
            <p class="text-gray-400 text-[10px] mt-3 font-bold uppercase tracking-wider">è¦å‰‡ï¼šåŒæ ¡è¿´é¿</p>
        </header>

        <div class="text-center mb-10 space-x-4">
            <button @click="startSmartDraw" class="bg-yellow-400 hover:bg-yellow-500 text-blue-900 font-black py-4 px-12 rounded-2xl shadow-xl transition-all active:scale-95 text-xl border-b-4 border-yellow-600">
                ğŸ² é–‹å§‹æŠ½ç±¤
            </button>
            
            <button v-if="groups.length > 0" @click="downloadCSV" class="bg-green-500 hover:bg-green-600 text-white font-black py-4 px-10 rounded-2xl shadow-xl transition-all active:scale-95 text-xl border-b-4 border-green-700">
                ğŸ“¥ ä¸‹è¼‰ CSV æª”æ¡ˆ
            </button>
        </div>

        <div v-if="groups.length > 0" class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div v-for="group in groups" :key="group.name" class="bg-white rounded-[2rem] shadow-sm border border-gray-100 overflow-hidden">
                <div class="bg-[#001f54] text-white py-4 text-center font-black tracking-widest text-lg">
                    {{ group.name }} <span class="text-yellow-400 text-sm">({{ group.teams.length }})</span>
                </div>
                <div class="p-6">
                    <ul class="space-y-3">
                        <li v-for="(team, idx) in group.teams" class="flex items-center font-bold text-gray-700 bg-gray-50 p-3 rounded-xl border border-gray-100">
                            <span class="w-10 h-10 bg-[#001f54] text-white rounded-lg flex items-center justify-center text-xs mr-4 shadow-sm flex-none">
                                {{ group.name.charAt(0) }}{{ idx + 1 }}
                            </span>
                            <span class="text-[14px] truncate">{{ team }}</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <footer class="mt-12 text-center text-gray-400 text-[10px] font-bold uppercase tracking-[0.2em]">
            2026 Chemistry Cup Draw System
        </footer>
    </div>

    <script>
        const { createApp } = Vue;
        createApp({
            data() {
                return {
                    selectedCategory: 'ç”·ç±ƒ',
                    groups: [],
                    categoryData: {
                        'ç”·ç±ƒ': { num4: 3, num3: 3, teams: ["ä¸­å±±é†«åŒ–", "æ±æµ·åŒ–å­¸", "è‡ºå¸«ç¯„åŒ–å­¸", "æ·¡æ±ŸåŒ–æ", "å˜‰å¤§æ‡‰åŒ–", "æˆå¤§åŒ–å­¸A", "æˆå¤§åŒ–å­¸B", "æ·¡æ±ŸåŒ–å­¸", "å—å¤§ç¶ èƒ½", "ä¸­èˆˆåŒ–å­¸", "é«˜é†«é†«åŒ–A", "é«˜é†«é†«åŒ–B", "å°å¤§åŒ–å­¸", "æ¸…å¤§åŒ–å­¸", "ä¸­æ­£åŒ–ç”Ÿ", "ä¸­åŸåŒ–å­¸", "äº¤å¤§æ‡‰åŒ–A", "äº¤å¤§æ‡‰åŒ–B", "æ±å³åŒ–å­¸", "è¼”ä»åŒ–å­¸A", "è¼”ä»åŒ–å­¸B"]},
                        'ç”·æ’': { num4: 1, num3: 8, teams: ["æš¨å¤§æ‡‰åŒ–", "å½°å¸«ç¯„åŒ–å­¸", "æ±æµ·åŒ–æè¯éšŠ", "è‡ºå¸«ç¯„åŒ–å­¸", "ä¸­å±±é†«åŒ–", "æ·¡æ±ŸåŒ–å­¸", "æ±è¯åŒ–æè¯éšŠ", "å°å¤§è¾²ç”Ÿè¯éšŠA", "å°å¤§è¾²ç”Ÿè¯éšŠB", "ä¸­èˆˆåŒ–å­¸A", "ä¸­èˆˆåŒ–å­¸B", "æˆå¤§åŒ–å­¸A", "æˆå¤§åŒ–å­¸B", "ä¸­å¤®åŒ–å­¸", "é«˜å¸«å¤§åŒ–å­¸", "é«˜é†«é†«åŒ–", "å°å¤§åŒ–å­¸", "ä¸­æ­£åŒ–ç”Ÿ", "é•·åºšåŒ–æ", "æ·¡æ±ŸåŒ–æ", "ä¸­åŸåŒ–å­¸A", "ä¸­åŸåŒ–å­¸B", "è¼”ä»åŒ–å­¸", "æ¸…å¤§åŒ–å­¸A", "æ¸…å¤§åŒ–å­¸B", "æ¸…å¤§åŒ–å­¸C", "äº¤å¤§æ‡‰åŒ–A", "äº¤å¤§æ‡‰åŒ–B"]},
                        'å¥³æ’': { num4: 0, num3: 6, teams: ["ä¸­å±±åŒ–å­¸", "è‡ºå¸«ç¯„åŒ–å­¸", "ä¸­åŸåŒ–å­¸", "å½°å¸«ç¯„åŒ–å­¸", "å°å¤§è¾²ç”Ÿè¯éšŠ", "ä¸­å±±é†«åŒ–", "æ±æµ·åŒ–å­¸", "å°å¤§åŒ–å­¸", "æ·¡æ±ŸåŒ–å­¸", "ä¸­èˆˆåŒ–å­¸", "æˆå¤§åŒ–å­¸", "é«˜é†«é†«åŒ–", "è¼”ä»åŒ–å­¸", "æ¸…å¤§åŒ–å­¸", "ä¸­æ­£åŒ–ç”Ÿ", "æ·¡æ±ŸåŒ–æ", "äº¤å¤§æ‡‰åŒ–A", "äº¤å¤§æ‡‰åŒ–B"]},
                        'ç¾½çƒåœ˜é«”': { num4: 2, num3: 5, teams: ["ä¸­å¤®åŒ–å­¸A", "ä¸­å¤®åŒ–å­¸B", "è‡ºå¸«ç¯„åŒ–å­¸", "ä¸­å±±é†«åŒ–", "ä¸­èˆˆåŒ–å­¸", "æˆå¤§åŒ–å­¸", "å½°å¸«ç¯„åŒ–å­¸", "é«˜é†«é†«åŒ–", "æš¨å—æ‡‰åŒ–A", "æš¨å—æ‡‰åŒ–B", "è¼”ä»åŒ–å­¸", "ä¸­æ­£åŒ–ç”ŸA", "ä¸­æ­£åŒ–ç”ŸB", "å°å¤§åŒ–å­¸A", "å°å¤§åŒ–å­¸B", "æ¸…å¤§åŒ–å­¸A", "æ¸…å¤§åŒ–å­¸B", "æ¸…å¤§åŒ–å­¸C", "ä¸­åŸåŒ–å­¸", "äº¤å¤§æ‡‰åŒ–A", "äº¤å¤§æ‡‰åŒ–B", "äº¤å¤§æ‡‰åŒ–C", "äº¤å¤§æ‡‰åŒ–V"]},
                        'ç”·å­å–®æ‰“': { num4: 0, num3: 18, teams: ["è‡ºå¸«ç¯„åŒ–å­¸å¼µçš“éˆ", "å°å¤§åŒ–å­¸å‚…ç®ç¥", "å±æ±åŒ–å­¸æ—å‡ç¿°", "å°å¤§åŒ–å­¸å³æ˜Ÿæ¯…", "ä¸­å¤®åŒ–å­¸å°ˆæå‡¡é‚‘", "å°å¤§åŒ–å­¸é»ƒå£«æ™", "æˆå¤§åŒ–å­¸é»ƒè–æ˜", "å°å¤§åŒ–å­¸å¼µç¿å®¸", "æˆå¤§åŒ–å­¸æç§‰æ¾", "å°å¤§åŒ–å­¸è¶™å®¶æ¨‚", "ä¸­èˆˆåŒ–å­¸å¼µç«‹æ˜•", "å°å¤§åŒ–å­¸æ¸¸é–”ç€š", "ä¸­èˆˆåŒ–å­¸é»ƒç«‘ç¶­", "å°å¤§åŒ–å­¸å§œä¼¯å¡", "ä¸­èˆˆåŒ–å­¸åŠ‰å®¶é½Š", "å°å¤§åŒ–å­¸æ±Ÿæª€", "ä¸­èˆˆåŒ–å­¸æ›¹ç¥ç‘‹", "å°å¤§åŒ–å­¸å‘¨é¦–å®‰", "æˆå¤§åŒ–å­¸èƒ¡å®‡å‰µ", "å°å¤§åŒ–å­¸ææ²›æ¾¤", "å½°å¸«ç¯„åŒ–å­¸æ¸¸å¥‡", "å°å¤§åŒ–å­¸é™³é™", "é«˜é†«é†«åŒ–é­ç¿é¨°", "å°å¤§åŒ–å­¸è¨±å¥•æ©", "é«˜é†«é†«åŒ–æ½˜æŸå‹³", "æ¸…å¤§åŒ–å­¸æ›¾æˆé³³", "é«˜é†«é†«åŒ–é»ƒè–å‡±", "æ¸…å¤§åŒ–å­¸é»ƒå•Ÿç‘‹", "é«˜é†«é†«åŒ–æ—æ•¬åº­", "ä¸­åŸåŒ–å­¸é™³è¯æ–‡", "é«˜é†«é†«åŒ–é¾æ˜“éŒ¡", "ä¸­åŸåŒ–å­¸ç¨‹æ³°éœ–", "æš¨å—æ‡‰åŒ–å³æ‰¿è»’", "ä¸­åŸåŒ–å­¸é™³ä¿Šæ†²", "æš¨å—æ‡‰åŒ–åŠ‰ç«‘å¿—", "ä¸­èˆˆåŒ–å­¸ç‹æ¢“ç¥¥", "æš¨å—æ‡‰åŒ–å½­ç«‹å®¸", "äº¤å¤§æ‡‰åŒ–ææ’å®‰", "æš¨å—æ‡‰åŒ–é»ƒå¥å¯Œ", "äº¤å¤§æ‡‰åŒ–è‘‰åŠ›ç¶¸", "è¼”ä»åŒ–å­¸èŠæŒ¯æš", "äº¤å¤§æ‡‰åŒ–å‘¨æ•¬è»’", "è¼”ä»åŒ–å­¸å¼µå°‘è¬™", "äº¤å¤§æ‡‰åŒ–åŠ‰å´´å€«", "è¼”ä»åŒ–å­¸æ—å®¥è¾°", "äº¤å¤§æ‡‰åŒ–å³ç‚«å»·", "è¼”ä»åŒ–å­¸é»ƒå† éœ–", "äº¤å¤§æ‡‰åŒ–é€£å®¸ç·¯", "è¼”ä»åŒ–å­¸æ¥Šå¸™ç¿”", "äº¤å¤§æ‡‰åŒ–è¬æ˜€å»·", "ä¸­æ­£åŒ–ç”Ÿè¬æ¬£å®", "éœå®œæ‡‰åŒ–åŠ‰å®‡ç¿”", "ä¸­æ­£åŒ–ç”Ÿæ½˜æ˜±ç¿", "ä¸­èˆˆåŒ–å­¸æ—åº·ç«‹"]},
                        'ç”·å­é›™æ‰“': { num4: 0, num3: 12, teams: ["è‡ºå¸«ç¯„åŒ–å­¸è”¡å®‡è»’/æ¥Šé›²äº˜", "å°å¤§åŒ–å­¸å³æ˜Ÿæ¯…/æ—è‚²ä¸", "å±æ±åŒ–å­¸æ—å‡ç¿°/æ—ç¥ç›", "å°å¤§åŒ–å­¸æ—è«ºè¼/æ¥Šå­æ¯…", "ä¸­å¤®åŒ–å­¸æå‡¡é‚‘/è”¡å®œå¡", "å°å¤§åŒ–å­¸å¼µç¿å®¸/è¶™å®¶æ¨‚", "ä¸­å¤®åŒ–å­¸å®‹æ‰¿æ†²/é¡å˜‰ä½‘", "äº¤å¤§æ‡‰åŒ–ææ’å®‰/å¼µå‹»æ•¬", "ä¸­å±±é†«åŒ–å³é´»æ•/è¢é©Š", "äº¤å¤§æ‡‰åŒ–å‘¨æ•¬è»’/æ—æ˜€é™", "è‡ºå¸«ç¯„åŒ–å­¸ææµšç¥/é»ƒç‘å®¸", "äº¤å¤§æ‡‰åŒ–æå®¥é ¡/éƒ­å£«æ„·", "ä¸­èˆˆåŒ–å­¸å¼µç«‹æ˜•/é™³è«–æš", "éœå®œæ‡‰åŒ–æ—æ™‰å¼˜/åŠ‰å®‡ç¿”", "ä¸­èˆˆåŒ–å­¸æ¶‚è‚²ä¸/é™³æŸå®‡", "äº¤å¤§æ‡‰åŒ–é»ƒæ‰¿å‹›/æ—ç§‰å„’", "æˆå¤§åŒ–å­¸æ´ªå®‡å®¸/åŠ‰å‡±æ±¶", "é«˜é†«é†«åŒ–é­ç¿é¨°/æå½¥å„’", "é«˜é†«é†«åŒ–è¬æ”¿å“²/ç‹è­‰æ£‹", "é«˜é†«é†«åŒ–é»ƒè–å‡±/é¾æ˜“éŒ¡", "é«˜é†«é†«åŒ–ç‹æ™¨æ—­/æŸ¯å“ä¸", "æš¨å—æ‡‰åŒ–ä½™éŸ‹éœ–/æå»ºå²‘", "æš¨å—æ‡‰åŒ–å³æ‰¿è»’/è¶™æ˜±éˆ", "æš¨å—æ‡‰åŒ–é»ƒç…œå®¸/ç¾…æ¥·ç¨‹", "è¼”å¤§åŒ–å­¸é™³å®¥ä¸/å¼µç´˜æ©", "è¼”å¤§åŒ–å­¸é»ƒå† éœ–/èŠæŒ¯æš", "è¼”å¤§åŒ–å­¸æ¸¸æ˜•å€«/é»ƒæ”¿ç¿”", "è¼”å¤§åŒ–å­¸æ¥Šå¸™ç¿”/æ¸¸æ™ºå‹›", "ä¸­æ­£åŒ–ç”Ÿé­æ˜±å‡±/é™³ç´€è±", "ä¸­æ­£åŒ–ç”Ÿé™³æ˜±äº˜/æ¸¸èƒ½è€€", "ä¸­æ­£åŒ–ç”Ÿå­«éƒå‚‘/è©¹å¿—ç…’", "ä¸­æ­£åŒ–ç”Ÿå¼µè‚²ç‘‹/è¬å®—è«º", "æ¸…å¤§åŒ–å­¸é™³æ·ä¸€/é™³å°šé€¸", "ä¸­åŸåŒ–å­¸é™³è¯æ–‡/ç¨‹æ³°éœ–", "å°å¤§åŒ–å­¸å‚…ç®ç¥/å§œä¼¯å¡", "å°å¤§åŒ–å­¸é™³é™/é™³ç¿Œè±"]},
                        'å¥³å­å–®æ‰“': { num4: 1, num3: 2, teams: ["é«˜é†«é†«åŒ–é™³å²åƒ‘", "æš¨å—æ‡‰åŒ–é«˜é–æš„", "æš¨å—æ‡‰åŒ–ç‹å®¶æ…§", "è¼”ä»åŒ–å­¸è˜‡åŠ›å¦", "è¼”ä»åŒ–å­¸é‚±ç­ å©·", "ä¸­æ­£åŒ–ç”Ÿè¬å®›è«­", "äº¤å¤§æ‡‰åŒ–æ¥Šæ˜€å®¹", "äº¤å¤§æ‡‰åŒ–é»ƒç­±æ¸", "äº¤å¤§æ‡‰åŒ–å”æºå¦¤", "äº¤å¤§æ‡‰åŒ–é™³ç­ çŠ"]}
                    }
                }
            },
            computed: {
                currentTeams() { return this.categoryData[this.selectedCategory].teams; }
            },
            methods: {
                resetDraw() { this.groups = []; },
                startSmartDraw() {
                    const teams = [...this.currentTeams];
                    const schoolGroups = {};
                    
                    teams.forEach(t => {
                        let k = t;
                        if (!t.includes("è¯éšŠ")) {
                            const schools = ["ä¸­å±±é†«", "ä¸­å±±", "å°å¤§", "æ¸…å¤§", "ä¸­èˆˆ", "äº¤å¤§", "æˆå¤§", "ä¸­åŸ", "æ·¡æ±Ÿ", "é«˜é†«", "è¼”ä»", "ä¸­å¤®", "æš¨å—", "ä¸­æ­£"];
                            for(let s of schools) { if(t.includes(s)) { k = s; break; } }
                            if(k === t) k = t.substring(0, 2);
                        }
                        if (!schoolGroups[k]) schoolGroups[k] = [];
                        schoolGroups[k].push(t);
                    });

                    let sortedSchoolKeys = Object.keys(schoolGroups).sort((a, b) => schoolGroups[b].length - schoolGroups[a].length);
                    const config = this.categoryData[this.selectedCategory];
                    const totalGroups = config.num4 + config.num3;
                    let finalGroups = Array.from({length: totalGroups}, () => []);

                    sortedSchoolKeys.forEach(schoolKey => {
                        let schoolTeams = [...schoolGroups[schoolKey]].sort(() => Math.random() - 0.5);
                        schoolTeams.forEach(team => {
                            let candidates = finalGroups.map((g, idx) => ({ idx, length: g.length, teams: g }))
                                .filter(g => {
                                    const limit = g.idx < config.num4 ? 4 : 3;
                                    const noSameSchool = !g.teams.some(existingTeam => existingTeam.includes(schoolKey));
                                    return g.length < limit && noSameSchool;
                                });

                            if (candidates.length > 0) {
                                const target = candidates[Math.floor(Math.random() * candidates.length)];
                                finalGroups[target.idx].push(team);
                            } else {
                                let mostEmpty = finalGroups.map((g, idx) => ({ idx, length: g.length }))
                                    .filter(g => g.length < (g.idx < config.num4 ? 4 : 3))
                                    .sort((a, b) => a.length - b.length)[0];
                                if(mostEmpty) finalGroups[mostEmpty.idx].push(team);
                            }
                        });
                    });

                    this.groups = finalGroups.map((g, i) => ({
                        name: String.fromCharCode(65 + i) + 'çµ„',
                        teams: g.sort(() => Math.random() - 0.5)
                    }));
                },
                downloadCSV() {
                    let csvContent = "\uFEFF"; 
                    csvContent += "é …ç›®,çµ„åˆ¥,åºè™Ÿ,éšŠä¼/é¸æ‰‹åç¨±\n";
                    
                    this.groups.forEach(group => {
                        group.teams.forEach((team, index) => {
                            const row = [
                                this.selectedCategory,
                                group.name,
                                group.name.charAt(0) + (index + 1),
                                `"${team}"` // åŠ å¼•è™Ÿé˜²æ­¢å…§å®¹æœ‰é€—è™Ÿå°è‡´è·‘æ ¼
                            ].join(",");
                            csvContent += row + "\n";
                        });
                    });

                    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement("a");
                    link.setAttribute("href", url);
                    link.setAttribute("download", `${this.selectedCategory}_æŠ½ç±¤çµæœ.csv`);
                    link.style.visibility = 'hidden';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                }
            }
        }).mount('#draw-app');
    </script>
</body>
</html>
